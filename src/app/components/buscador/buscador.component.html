<!-- Barra de bÃºsqueda, categorÃ­a e idioma -->
<div class="buscador">
  <input
    type="text"
    placeholder="ğŸ” Busca libros..."
    [(ngModel)]="termino"
    (input)="onInputChange(termino)"
    aria-label="Buscar libros"
  />

  <select [(ngModel)]="categoriaSeleccionada" (change)="onCategoriaChange(categoriaSeleccionada)">
    <option value="">ğŸ“‚ Todas las categorÃ­as</option>
    <option value="Fiction">ğŸ“– FicciÃ³n</option>
    <option value="Science">ğŸ”¬ Ciencia</option>
    <option value="History">ğŸ“œ Historia</option>
    <option value="Biography">ğŸ§‘â€ğŸ« BiografÃ­a</option>
    <option value="Art">ğŸ¨ Arte</option>
    <option value="Technology">ğŸ’» TecnologÃ­a</option>
  </select>

  <select [(ngModel)]="idiomaSeleccionado" (change)="onIdiomaChange(idiomaSeleccionado)">
    <option value="">ğŸŒ Todos los idiomas</option>
    <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
    <option value="en">ğŸ‡ºğŸ‡¸ InglÃ©s</option>
    <option value="fr">ğŸ‡«ğŸ‡· FrancÃ©s</option>
    <option value="de">ğŸ‡©ğŸ‡ª AlemÃ¡n</option>
    <option value="it">ğŸ‡®ğŸ‡¹ Italiano</option>
    <option value="pt">ğŸ‡µğŸ‡¹ PortuguÃ©s</option>
  </select>
</div>

<!-- Grid de resultados -->
<div class="grid-libros">
  <div
    class="card libro-card"
    *ngFor="let libro of libros"
    (click)="seleccionarLibro(libro)"
  >
    <img
      [src]="libro.volumeInfo?.imageLinks?.thumbnail || 'https://via.placeholder.com/128x200?text=No+Image'"
      [alt]="libro.volumeInfo?.title || 'Libro sin tÃ­tulo'"
      class="portada"
    />
    <div class="info">
      <h3 class="titulo">{{ libro.volumeInfo?.title }}</h3>
      <button
        (click)="agregarAFavoritos(libro); $event.stopPropagation()"
        class="btn-fav"
        type="button"
      >
        â­ AÃ±adir a favoritos
      </button>
    </div>
  </div>
</div>

<!-- Indicador de carga -->
<div *ngIf="cargando" class="loader">ğŸ“š Buscando libros...</div>

<!-- Mensaje si no hay resultados -->
<div *ngIf="!cargando && libros.length === 0" class="mensaje-vacio">
  âŒ No se encontraron libros con ese tÃ©rmino, categorÃ­a o idioma.
</div>

<!-- ğŸ”» INICIO SECCIÃ“N FAVORITOS ğŸ”» -->
<div id="seccion-favoritos" class="favoritos">
  <h2>
    â­ Favoritos
    <button
      class="btn-subir"
      (click)="subirArriba()"
      aria-label="Subir arriba"
      type="button"
    >
      â¬†ï¸
    </button>
  </h2>

  <div *ngIf="favoritos.length === 0">
    <p>No tienes libros guardados.</p>
  </div>

  <div class="grid-libros">
    <div
      class="card libro-card"
      *ngFor="let fav of favoritos"
      (click)="seleccionarLibro(fav)"
    >
      <img
        [src]="fav.volumeInfo?.imageLinks?.thumbnail || 'https://via.placeholder.com/128x200?text=No+Image'"
        [alt]="fav.volumeInfo?.title || 'Libro sin tÃ­tulo'"
        class="portada"
      />
      <div class="info">
        <h3 class="titulo">{{ fav.volumeInfo?.title }}</h3>
        <button
          (click)="eliminarFavorito(fav.id); $event.stopPropagation()"
          class="btn-remove"
          type="button"
        >
          âŒ Quitar
        </button>
      </div>
    </div>
  </div>

  <!-- SecciÃ³n de detalles del libro -->
  <div
    id="detalles-libro"
    class="detalles-libro"
    *ngIf="libroSeleccionado"
  >
    <h2>
      ğŸ“š Detalles del libro
      <button
        class="btn-subir"
        (click)="subirArriba()"
        aria-label="Subir arriba"
        type="button"
      >
        â¬†ï¸
      </button>
    </h2>

    <div class="detalles-contenido">
      <img
        [src]="libroSeleccionado.volumeInfo?.imageLinks?.thumbnail || 'https://via.placeholder.com/128x200?text=No+Image'"
        [alt]="libroSeleccionado.volumeInfo?.title || 'Libro sin tÃ­tulo'"
        class="portada-detalle"
      />

      <div class="info-detalle">
        <h3>{{ libroSeleccionado.volumeInfo?.title }}</h3>
        <p><strong>Autor(es):</strong> {{ libroSeleccionado.volumeInfo?.authors?.join(', ') || 'No disponible' }}</p>
        <p><strong>Editorial:</strong> {{ libroSeleccionado.volumeInfo?.publisher || 'No disponible' }}</p>
        <p><strong>Publicado:</strong> {{ libroSeleccionado.volumeInfo?.publishedDate || 'No disponible' }}</p>
        <p><strong>DescripciÃ³n:</strong> <span [innerHTML]="libroSeleccionado.volumeInfo?.description || 'No disponible'"></span></p>
        <p><strong>PÃ¡ginas:</strong> {{ libroSeleccionado.volumeInfo?.pageCount || 'No disponible' }}</p>
        <p><strong>Idioma:</strong> {{ libroSeleccionado.volumeInfo?.language || 'No disponible' }}</p>
        <p><strong>Rating:</strong> {{ libroSeleccionado.volumeInfo?.averageRating || 'No disponible' }}</p>
        <a [href]="libroSeleccionado.volumeInfo?.infoLink" target="_blank" rel="noopener noreferrer">MÃ¡s info en Google Books</a>

        <!-- BotÃ³n para aÃ±adir o quitar favorito en detalles -->
<button
  *ngIf="!esFavorito(libroSeleccionado.id)"
  (click)="agregarAFavoritos(libroSeleccionado)"
  class="btn-fav"
  type="button"
>
  â­ AÃ±adir a favoritos
</button>

<button
  *ngIf="esFavorito(libroSeleccionado.id)"
  (click)="eliminarFavorito(libroSeleccionado.id)"
  class="btn-remove"
  type="button"
>
  âŒ Quitar de favoritos
</button>

</div>
